webpackJsonp([1],{"BK/C":function(t,i){},NHnr:function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=n("7+uW"),a=n("BO1k"),s=n.n(a),c=n("bOdI"),o=n.n(c);document.addEventListener("DOMContentLoaded",function(){var t;t=document.getElementById("audio"),document.addEventListener("WeixinJSBridgeReady",function(){t.play()},!1)});var l="https://fitment.chenyoujiu.com";e.a.filter("img",function(t){return t?l+t:null});var u={name:"App",data:function(){var t;return t={lastopt:(new Date).getTime(),id:null,width:null,height:null,loaded:!1,num:0,total:0,play:!1,menu:null,menuVisible:!0,wxCfged:!1},o()(t,"loaded",!1),o()(t,"pageSwitch",!0),o()(t,"bgSwitch",!0),o()(t,"album",{background:"",title:"",music:"",share_content:"",share_icon:"",close_share:"",close_ad:"",pic:[],producer:{username:"",icon:"",phone:""}}),t},mounted:function(){var t=this.findParams();if(this.id=t.id,this.width=Number(t.width),this.height=Number(t.height),this.id){try{document.getElementById("fy").load()}catch(t){}this.load(),this.loadWXCfg(),this.autoClose()}},methods:{markLastOpt:function(){this.lastopt=(new Date).getTime(),console.log("mark...")},findParams:function(){var t={},i=window.location.search;if(i){var n=(i=i.substring(1)).split("&"),e=!0,a=!1,c=void 0;try{for(var o,l=s()(n);!(e=(o=l.next()).done);e=!0){var u=o.value.split("=");t[u[0]]=u[1]}}catch(t){a=!0,c=t}finally{try{!e&&l.return&&l.return()}finally{if(a)throw c}}}return t},load:function(){var t=this;$.post("/picApi/factoryAlbumInfo",{id:this.id},function(i){i.code||(t.render(i.result.album),t.loaded=!0,t.initShare(),t.$nextTick(function(){document.getElementById("audio").play(),$(window).on("touchstart",function(){t.bgSwitch&&document.getElementById("audio").play(),t.pageSwitch&&document.getElementById("fy").load()})}),window.onorientationchange=function(){setTimeout(function(){t.resize()},500)})})},loadWXCfg:function(){var t=this;$.post("/wxApi/shareConfig",null,function(i){var n=i.result[0];wx.config({appId:n.appId,timestamp:n.timestamp,nonceStr:n.nonceStr,signature:n.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone"]});var e=t;wx.ready(function(){e.wxCfged=!0,e.initShare()}),wx.error(function(t){console.log(t)})})},render:function(t){var i=this;document.title=t.title,t.background||(t.background="/static/albums/album-bg.png"),t.share_icon||(t.share_icon="/static/albums/album-icon.png"),t.share_content||(t.share_content="新款画册发布"),t.music||(t.music="/static/albums/bg.mp3");var n=!0,e=!1,a=void 0;try{for(var c,o=s()(t.pic);!(n=(c=o.next()).done);n=!0){var u=c.value;u.thumbnail=l+u.thumbnail,u.url=l+u.url}}catch(t){e=!0,a=t}finally{try{!n&&o.return&&o.return()}finally{if(e)throw a}}this.album=t,this.loaded=!0,this.$nextTick(function(){i.initTurn()})},calSize:function(){$($(this.$refs.ct));var t=$(window),i=this.album.pic[0].thumbnail_height,n=this.album.pic[0].thumbnail_width,e=t.width()-10,a=t.height(),s=null,c=null,o=null;return e>a?(s="double",(o=i/n*(c=e-20)/2)>a&&(c=n/i*(o=a-20)*2)):(s="single",(o=i/n*(c=e-10))>a&&(c=n/i*(o=a-10))),{display:s,w:c,h:o}},resize:function(){var t=this.calSize(),i=$(this.$refs.ct);i.turn("size",t.w,t.h),i.turn("display",t.display),i.turn("resize")},initTurn:function(){var t=this.calSize(),i=this;$(this.$refs.ct).turn({width:t.w,height:t.h,display:t.display,autoCenter:!0,when:{turning:function(){if(i.pageSwitch){var t=document.getElementById("fy");t.load(),t.play()}}}}),this.play&&this.start()},active:function(t){this.menu===t?this.menu=null:this.menu=t},toPage:function(t,i,n){if(!(t<0||t>=this.album.pic.length)){var e=t+1;n&&(this.menu=null),$(this.$refs.ct).turn("page",e),this.num=e}},toggle:function(t){this.toPage($(this.$refs.ct).turn("page")+t-1)},stop:function(){this.timer&&clearInterval(this.timer),this.timer=null},start:function(){var t=this;this.stop(),this.timer=setInterval(function(){t.nextPage()},3e3)},nextPage:function(){var t=$(this.$refs.ct).turn("page");t>=this.album.pic.length?t=1:t++,this.toPage(t-1)},turnPlay:function(){this.play?(this.nextPage(),this.start()):this.stop()},initShare:function(){if(this.loaded&&this.wxCfged){console.log("init share");var t=window.location.href.replace(/#\S*/,""),i=this.album.title,n=this.album.share_content||i,e=window.location.origin+this.album.share_icon;wx.onMenuShareTimeline({title:n,link:t,imgUrl:e,success:function(){},cancel:function(){}}),wx.onMenuShareAppMessage({title:i,desc:n,link:t,imgUrl:e,type:"link",success:function(){},cancel:function(){}}),wx.onMenuShareQQ({title:i,desc:n,link:t,imgUrl:e,success:function(){},cancel:function(){}}),wx.onMenuShareWeibo({title:i,desc:n,link:t,imgUrl:e,success:function(){},cancel:function(){}}),wx.onMenuShareQZone({title:i,desc:n,link:t,imgUrl:e,success:function(){},cancel:function(){}})}},autoClose:function(){var t=this;this.stopTimer(),this.autoTimer=setInterval(function(){(new Date).getTime()-t.lastopt>=3e3&&!t.menu&&(t.menuVisible=!1)},1500)},stopTimer:function(){this.autoTimer&&(clearInterval(this.autoTimer),this.autoTimer=null)}},watch:o()({menu:function(t){"page"===t&&(this.num=$(this.$refs.ct).turn("page"),this.total=this.album.pic.length)},bgSwitch:function(t){if(this.album.music){var i=document.getElementById("audio");t?i.play():i.pause()}},play:function(){this.turnPlay()},menuVisible:function(){this.menuVisible||(this.menu=null)}},"menuVisible",function(){this.menuVisible?this.autoClose():this.stopTimer()})},r={render:function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("div",{attrs:{id:"app"},on:{click:function(i){t.markLastOpt()}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.menuVisible,expression:"menuVisible"}],staticClass:"flex-row tbar"},[n("img",{attrs:{src:t._f("img")(t.album.producer.icon)}}),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:"1"!=t.album.close_ad,expression:"album.close_ad != '1'"}]},[t._v(t._s(t.album.producer.username))]),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:"1"!=t.album.close_ad,expression:"album.close_ad != '1'"}]},[t._v(t._s(t.album.producer.phone))])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.loaded,expression:"loaded"}],staticClass:"content",style:{"background-image":"url("+t.album.background+")"}},[n("div",{ref:"ct",on:{click:function(i){t.menuVisible=!t.menuVisible}}},t._l(t.album.pic,function(t){return n("div",{staticClass:"pic",style:{"background-image":"url("+t.url+")"}})}))]),t._v(" "),"list"===t.menu?n("div",{staticClass:"list menu"},[n("div",{staticClass:"list-cont"},t._l(t.album.pic,function(i,e){return n("div",{staticClass:"list-item",on:{click:function(n){t.toPage(e,i,!0)}}},[n("img",{attrs:{src:i.thumbnail}}),t._v(" "),n("div",{staticClass:"page-txt"},[t._v("\n                    "+t._s(e+1)+"\n                ")])])}))]):t._e(),t._v(" "),"music"===t.menu?n("div",{staticClass:"xtoggle menu menu-bar"},[n("div",{staticClass:"check-group"},[t._v("翻页开关"),n("span",{staticClass:"xcheck",class:{active:t.pageSwitch},on:{click:function(i){t.pageSwitch=!t.pageSwitch}}})]),t._v(" "),n("div",{staticClass:"check-group"},[t._v("背景开关"),n("span",{staticClass:"xcheck",class:{active:t.bgSwitch},on:{click:function(i){t.bgSwitch=!t.bgSwitch}}})])]):t._e(),t._v(" "),"page"===t.menu?n("div",{staticClass:"xpage menu menu-bar"},[n("div",{staticClass:"xpage-icon first",on:{click:function(i){t.toPage(0)}}}),t._v(" "),n("div",{staticClass:"xpage-icon pre",on:{click:function(i){t.toggle(-1)}}}),t._v(" "),n("div",{staticClass:"xpage-txt"},[n("span",[t._v(t._s(t.num))]),n("span",[t._v("/")]),n("span",[t._v(t._s(t.total))])]),t._v(" "),n("div",{staticClass:"xpage-icon next",on:{click:function(i){t.toggle(1)}}}),t._v(" "),n("div",{staticClass:"xpage-icon last",on:{click:function(i){t.toPage(t.total-1)}}})]):t._e(),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.menuVisible,expression:"menuVisible"}],staticClass:"flex-row bbar"},[n("div",{staticClass:"bbar-btn",on:{click:function(i){t.active("list")}}},[n("div",{staticClass:"icon icon-list",class:{active:"list"===t.menu}})]),t._v(" "),n("div",{staticClass:"bbar-btn",on:{click:function(i){t.active("page")}}},[n("div",{staticClass:"icon icon-page",class:{active:"page"===t.menu}})]),t._v(" "),n("div",{staticClass:"bbar-btn",on:{click:function(i){t.active("music")}}},[n("div",{staticClass:"icon icon-music",class:{active:"music"===t.menu}})]),t._v(" "),n("div",{staticClass:"bbar-btn",on:{click:function(i){t.play=!t.play}}},[n("div",{staticClass:"icon icon-play",class:{active:t.play}})])]),t._v(" "),n("div",{staticStyle:{display:"none"}},[n("audio",{attrs:{src:t.album.music,autoplay:"true",loop:"true",id:"audio"}}),t._v(" "),n("audio",{attrs:{src:"/static/albums/fy.mp3",id:"fy"}})])])},staticRenderFns:[]};var h=n("VU/8")(u,r,!1,function(t){n("BK/C")},null,null).exports;e.a.config.productionTip=!1,new e.a({el:"#app",components:{App:h},template:"<App/>"})}},["NHnr"]);
//# sourceMappingURL=app.e7fb30073b6c67a85fef.js.map