/*
 svg.panzoom.js - A plugin for svg.js that enables panzoom for viewport elements
 @version 1.1.1
 https://github.com/svgdotjs/svg.panzoom.js#readme

 @copyright Ulrich-Matthias SchÃ¤fer
 @license MIT
*/
(function(){var m=function(b){b.touches||(b.touches=[{clientX:b.clientX,clientY:b.clientY}]);return b.touches};SVG.extend(SVG.Doc,SVG.Nested,{panZoom:function(b){this.off(".panZoom");if(!1===b)return this;b=b||{};var e=b.zoomFactor||.03,f=b.zoomMin||Number.MIN_VALUE,g=b.zoomMax||Number.MAX_VALUE,d,c,h=!1,k=function(a){c=m(a);2>c.length||(a.preventDefault(),this.fire("pinchZoomStart",{event:a}).event().defaultPrevented||(this.off("touchstart.panZoom",k),h=!0,SVG.on(document,"touchmove.panZoom",q,this,
{passive:!1}),SVG.on(document,"touchend.panZoom",r,this,{passive:!1})))},r=function(a){a.preventDefault();h=!1;this.fire("pinchZoomEnd",{event:a});SVG.off(document,"touchmove.panZoom",q);SVG.off(document,"touchend.panZoom",r);this.on("touchstart.panZoom",k)},q=function(a){a.preventDefault();a=m(a);var b=this.zoom(),d=Math.sqrt(Math.pow(c[0].clientX-c[1].clientX,2)+Math.pow(c[0].clientY-c[1].clientY,2))/Math.sqrt(Math.pow(a[0].clientX-a[1].clientX,2)+Math.pow(a[0].clientY-a[1].clientY,2));if(b<f&&
1<d||b>g&&1>d)d=1;var e=a[0].clientX+.5*(a[1].clientX-a[0].clientX),h=a[0].clientY+.5*(a[1].clientY-a[0].clientY),k=c[0].clientX+.5*(c[1].clientX-c[0].clientX),l=c[0].clientY+.5*(c[1].clientY-c[0].clientY),b=this.point(e,h),e=this.point(2*e-k,2*h-l),d=(new SVG.Box(this.viewbox())).transform((new SVG.Matrix).translate(b.x,b.y).scale(d,0,0).translate(-e.x,-e.y));this.viewbox(d);c=a;this.fire("zoom",{box:d,focus:e})},l=function(a){c=m(a);1<c.length||(a.preventDefault(),this.off("mousedown.panZoom",l),
this.off("touchstart.panZoom",l),h||(this.fire("panStart",{event:a}),d={x:c[0].clientX,y:c[0].clientY},SVG.on(document,"mousemove.panZoom",n,this),SVG.on(document,"mouseup.panZoom",p,this),SVG.on(document,"touchmove.panZoom",n,this),SVG.on(document,"touchend.panZoom",p,this)))},p=function(a){a.preventDefault();this.fire("panEnd",{event:a});SVG.off(document,"mousemove.panZoom",n);SVG.off(document,"mouseup.panZoom",p);SVG.off(document,"touchmove.panZoom",n);SVG.off(document,"touchend.panZoom",p);this.on("touchstart.panZoom",
l)},n=function(a){a=m(a);a={x:a[0].clientX,y:a[0].clientY};var b=this.point(a.x,a.y),c=this.point(d.x,d.y),b=[c.x-b.x,c.y-b.y],b=(new SVG.Box(this.viewbox())).transform((new SVG.Matrix).translate(b[0],b[1]));this.viewbox(b);d=a};this.on("wheel.panZoom",function(a){a.preventDefault();if(0!=a.deltaY){var b=this.zoom()-e*a.deltaY/Math.abs(a.deltaY);a=this.point(a.clientX,a.clientY);b>g&&(b=g);b<f&&(b=f);this.zoom(b,a)}});this.on("touchstart.panZoom",k,this,{passive:!1});this.on("touchstart.panZoom",
l,this);this.on("mousedown.panZoom",l,this);return this},zoom:function(b,e){var f=window.getComputedStyle(this.node),g=parseFloat(f.getPropertyValue("width")),f=parseFloat(f.getPropertyValue("height")),d=this.viewbox(),c=g/d.width,h=f/d.height,k=Math.min(c,h);if(null==b)return k;b=k/b;Infinity===b&&(b=Number.MIN_VALUE);e=e||new SVG.Point(g/2/c+d.x,f/2/h+d.y);g=(new SVG.Box(d)).transform((new SVG.Matrix).scale(b,e.x,e.y));return this.fire("zoom",{box:g,focus:e}).event().defaultPrevented?this:this.viewbox(g)}});
SVG.extend(SVG.FX,{zoom:function(b,e){return this.add("zoom",[new SVG.Number(b)].concat(e||[]))}})})();
